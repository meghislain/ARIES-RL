[[0.01917244 0.1001197  0.01917244]
 [0.1001197  0.52283142 0.1001197 ]
 [0.01917244 0.1001197  0.01917244]]
 training :  [[17.         19.26929697 17.76510724]
 [17.         13.74802295 16.1815104 ]
 [17.         18.84338035 17.73756945]
 [17.         16.12260654 16.67970023]
 [17.         16.94587262 17.02228892]
 [17.         16.46027247 16.93405878]
 [17.         20.11520242 18.04673715]
 [17.         20.54475003 17.93327414]
 [17.         15.27562607 16.61552891]
 [17.         20.11982891 17.77775213]
 [17.         15.29103946 16.47435477]
 [17.         20.52763992 18.25170935]
 [17.         13.42002059 15.96176483]
 [17.         13.66776735 16.10626275]
 [17.         16.47487574 16.89650907]
 [17.         16.8783225  17.06817174]
 [17.         17.33525855 17.12855377]
 [17.         13.05235119 15.76885855]
 [17.         21.03162094 18.39503935]
 [17.         18.62033577 17.4576928 ]
 [17.         17.73264914 17.02838972]
 [17.         13.05061338 15.63778101]
 [17.         19.31603039 17.63461975]
 [17.         19.14465587 17.60511305]
 [17.         14.04952    16.15230006]
 [17.         21.0143829  18.25025426]
 [17.         20.57391553 18.11223764]
 [17.         13.46741338 15.88976012]
 [17.         21.04967787 18.05256494]
 [17.         21.04946386 18.21116318]
 [17.         16.48136405 16.67646714]
 [17.         16.39254864 16.75246451]
 [17.         15.44011518 16.4517667 ]
 [17.         13.13878347 15.88622087]
 [17.         15.99260554 16.60418138]
 [17.         13.12179706 15.80059733]
 [17.         13.1462894  15.84156095]
 [17.         20.96193069 18.21975257]
 [17.         16.1952468  16.84958973]
 [17.         16.76869908 16.90343161]
 [17.         17.74382336 17.34229847]
 [17.         15.75950495 16.66555405]
 [17.         13.83556322 15.93445081]
 [17.         16.21396756 16.85834345]
 [17.         14.18823678 16.08837115]
 [17.         15.01342976 16.54563328]
 [17.         20.69105571 18.14271665]
 [17.         19.87082608 18.02344667]
 [17.         13.75737506 16.05109757]
 [17.         18.01485449 17.3203959 ]
 [17.         17.61895144 17.22690556]
 [17.         21.01896811 18.14062792]
 [17.         20.53403821 17.95860571]
 [17.         13.2981259  15.69860631]
 [17.         19.18000882 17.80382053]
 [17.         20.48085532 17.96591863]
 [17.         14.40074307 16.29956599]
 [17.         15.11019841 16.48386385]
 [17.         15.36550115 16.54739993]
 [17.         13.67756594 16.1446083 ]
 [17.         13.7564545  16.00182198]
 [17.         13.74413818 16.05871314]
 [17.         19.19259847 17.64202636]
 [17.         14.83993157 16.32121006]
 [17.         20.41927902 17.92613754]
 [17.         18.56961537 17.36353646]
 [17.         20.93027612 18.2099344 ]
 [17.         19.33505972 17.76092369]
 [17.         19.56925989 17.78632667]
 [17.         16.44563105 16.88513739]] 70
 validation :  [[17.         18.78013605 17.32253521]
 [17.         20.95941087 18.20545837]
 [17.         16.45641096 16.97709855]
 [17.         13.27288561 15.86694264]
 [17.         19.90815881 17.92311769]
 [17.         19.26747512 17.73622021]
 [17.         21.04799355 18.13833669]
 [17.         20.37190419 18.05962364]
 [17.         20.17334485 18.10968087]
 [17.         16.91603331 16.86340314]
 [17.         14.64146416 16.50356244]
 [17.         20.76509604 18.06697054]
 [17.         13.98508937 16.11222218]
 [17.         20.75560835 17.99460778]
 [17.         19.18252485 17.68504113]
 [17.         13.73245334 15.86685592]
 [17.         13.92147411 16.07017765]
 [17.         21.04995365 18.00438117]
 [17.         16.61378671 16.90705985]
 [17.         16.89304556 16.93978839]
 [17.         18.65182608 17.52025053]
 [17.         13.19822298 15.77403593]
 [17.         18.53771257 17.47635054]
 [17.         20.52786428 17.82643991]
 [17.         16.22197615 16.55963703]
 [17.         20.81713034 18.17921857]
 [17.         16.64528319 16.95980106]
 [17.         18.18653081 17.4023596 ]
 [17.         19.68999848 17.77791487]
 [17.         18.36714651 17.3487095 ]] 30
[[0.01917244 0.1001197  0.01917244]
 [0.1001197  0.52283142 0.1001197 ]
 [0.01917244 0.1001197  0.01917244]]
 training :  [[17.         19.26929697 17.76510724]
 [17.         13.74802295 16.1815104 ]
 [17.         18.84338035 17.73756945]
 [17.         16.12260654 16.67970023]
 [17.         16.94587262 17.02228892]
 [17.         16.46027247 16.93405878]
 [17.         20.11520242 18.04673715]
 [17.         20.54475003 17.93327414]
 [17.         15.27562607 16.61552891]
 [17.         20.11982891 17.77775213]
 [17.         15.29103946 16.47435477]
 [17.         20.52763992 18.25170935]
 [17.         13.42002059 15.96176483]
 [17.         13.66776735 16.10626275]
 [17.         16.47487574 16.89650907]
 [17.         16.8783225  17.06817174]
 [17.         17.33525855 17.12855377]
 [17.         13.05235119 15.76885855]
 [17.         21.03162094 18.39503935]
 [17.         18.62033577 17.4576928 ]
 [17.         17.73264914 17.02838972]
 [17.         13.05061338 15.63778101]
 [17.         19.31603039 17.63461975]
 [17.         19.14465587 17.60511305]
 [17.         14.04952    16.15230006]
 [17.         21.0143829  18.25025426]
 [17.         20.57391553 18.11223764]
 [17.         13.46741338 15.88976012]
 [17.         21.04967787 18.05256494]
 [17.         21.04946386 18.21116318]
 [17.         16.48136405 16.67646714]
 [17.         16.39254864 16.75246451]
 [17.         15.44011518 16.4517667 ]
 [17.         13.13878347 15.88622087]
 [17.         15.99260554 16.60418138]
 [17.         13.12179706 15.80059733]
 [17.         13.1462894  15.84156095]
 [17.         20.96193069 18.21975257]
 [17.         16.1952468  16.84958973]
 [17.         16.76869908 16.90343161]
 [17.         17.74382336 17.34229847]
 [17.         15.75950495 16.66555405]
 [17.         13.83556322 15.93445081]
 [17.         16.21396756 16.85834345]
 [17.         14.18823678 16.08837115]
 [17.         15.01342976 16.54563328]
 [17.         20.69105571 18.14271665]
 [17.         19.87082608 18.02344667]
 [17.         13.75737506 16.05109757]
 [17.         18.01485449 17.3203959 ]
 [17.         17.61895144 17.22690556]
 [17.         21.01896811 18.14062792]
 [17.         20.53403821 17.95860571]
 [17.         13.2981259  15.69860631]
 [17.         19.18000882 17.80382053]
 [17.         20.48085532 17.96591863]
 [17.         14.40074307 16.29956599]
 [17.         15.11019841 16.48386385]
 [17.         15.36550115 16.54739993]
 [17.         13.67756594 16.1446083 ]
 [17.         13.7564545  16.00182198]
 [17.         13.74413818 16.05871314]
 [17.         19.19259847 17.64202636]
 [17.         14.83993157 16.32121006]
 [17.         20.41927902 17.92613754]
 [17.         18.56961537 17.36353646]
 [17.         20.93027612 18.2099344 ]
 [17.         19.33505972 17.76092369]
 [17.         19.56925989 17.78632667]
 [17.         16.44563105 16.88513739]] 70
 validation :  [[17.         18.78013605 17.32253521]
 [17.         20.95941087 18.20545837]
 [17.         16.45641096 16.97709855]
 [17.         13.27288561 15.86694264]
 [17.         19.90815881 17.92311769]
 [17.         19.26747512 17.73622021]
 [17.         21.04799355 18.13833669]
 [17.         20.37190419 18.05962364]
 [17.         20.17334485 18.10968087]
 [17.         16.91603331 16.86340314]
 [17.         14.64146416 16.50356244]
 [17.         20.76509604 18.06697054]
 [17.         13.98508937 16.11222218]
 [17.         20.75560835 17.99460778]
 [17.         19.18252485 17.68504113]
 [17.         13.73245334 15.86685592]
 [17.         13.92147411 16.07017765]
 [17.         21.04995365 18.00438117]
 [17.         16.61378671 16.90705985]
 [17.         16.89304556 16.93978839]
 [17.         18.65182608 17.52025053]
 [17.         13.19822298 15.77403593]
 [17.         18.53771257 17.47635054]
 [17.         20.52786428 17.82643991]
 [17.         16.22197615 16.55963703]
 [17.         20.81713034 18.17921857]
 [17.         16.64528319 16.95980106]
 [17.         18.18653081 17.4023596 ]
 [17.         19.68999848 17.77791487]
 [17.         18.36714651 17.3487095 ]] 30
device :  cuda:2
/linux/meghislain/ARIES-RL/stable_baselines3/common/vec_env/patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
MultiInputPolicy(
  (q_net): QNetwork(
    (features_extractor): CombinedExtractor(
      (extractors): ModuleDict(
        (doseMaps): NatureCNN(
          (cnn): Sequential(
            (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1))
            (1): ReLU()
            (2): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1))
            (3): ReLU()
            (4): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
            (5): ReLU()
            (6): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
            (7): ReLU()
            (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1))
            (9): ReLU()
            (10): Flatten(start_dim=1, end_dim=-1)
          )
          (linear): Sequential(
            (0): Linear(in_features=73728, out_features=256, bias=True)
            (1): ReLU()
          )
        )
        (incert): NatureCNN(
          (cnn): Sequential(
            (0): Conv2d(2, 16, kernel_size=(3, 3), stride=(1, 1))
            (1): ReLU()
            (2): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1))
            (3): ReLU()
            (4): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
            (5): ReLU()
            (6): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
            (7): ReLU()
            (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1))
            (9): ReLU()
            (10): Flatten(start_dim=1, end_dim=-1)
          )
          (linear): Sequential(
            (0): Linear(in_features=73728, out_features=256, bias=True)
            (1): ReLU()
          )
        )
      )
    )
    (q_net): Sequential(
      (0): Linear(in_features=512, out_features=128, bias=True)
      (1): ReLU()
      (2): Linear(in_features=128, out_features=64, bias=True)
      (3): ReLU()
      (4): Linear(in_features=64, out_features=32, bias=True)
      (5): ReLU()
      (6): Linear(in_features=32, out_features=6, bias=True)
    )
  )
  (q_net_target): QNetwork(
    (features_extractor): CombinedExtractor(
      (extractors): ModuleDict(
        (doseMaps): NatureCNN(
          (cnn): Sequential(
            (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1))
            (1): ReLU()
            (2): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1))
            (3): ReLU()
            (4): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
            (5): ReLU()
            (6): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
            (7): ReLU()
            (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1))
            (9): ReLU()
            (10): Flatten(start_dim=1, end_dim=-1)
          )
          (linear): Sequential(
            (0): Linear(in_features=73728, out_features=256, bias=True)
            (1): ReLU()
          )
        )
        (incert): NatureCNN(
          (cnn): Sequential(
            (0): Conv2d(2, 16, kernel_size=(3, 3), stride=(1, 1))
            (1): ReLU()
            (2): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1))
            (3): ReLU()
            (4): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
            (5): ReLU()
            (6): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1))
            (7): ReLU()
            (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1))
            (9): ReLU()
            (10): Flatten(start_dim=1, end_dim=-1)
          )
          (linear): Sequential(
            (0): Linear(in_features=73728, out_features=256, bias=True)
            (1): ReLU()
          )
        )
      )
    )
    (q_net): Sequential(
      (0): Linear(in_features=512, out_features=128, bias=True)
      (1): ReLU()
      (2): Linear(in_features=128, out_features=64, bias=True)
      (3): ReLU()
      (4): Linear(in_features=64, out_features=32, bias=True)
      (5): ReLU()
      (6): Linear(in_features=32, out_features=6, bias=True)
    )
  )
)
epoch number :  0
training mode :  0 [17.         20.11982891 17.77775213]
Traceback (most recent call last):
  File "/linux/meghislain/ARIES-RL/main.py", line 57, in <module>
    model.learn(total_timesteps=TIMESTEPS)
  File "/linux/meghislain/ARIES-RL/stable_baselines3/dqn/dqn.py", line 268, in learn
    return super().learn(
  File "/linux/meghislain/ARIES-RL/stable_baselines3/common/off_policy_algorithm.py", line 329, in learn
    rollout = self.collect_rollouts(
  File "/linux/meghislain/ARIES-RL/stable_baselines3/common/off_policy_algorithm.py", line 561, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(actions)
  File "/linux/meghislain/ARIES-RL/stable_baselines3/common/vec_env/base_vec_env.py", line 206, in step
    return self.step_wait()
  File "/linux/meghislain/ARIES-RL/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/linux/meghislain/ARIES-RL/stable_baselines3/common/monitor.py", line 94, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
  File "/home/meghislain/.conda/envs/STB3/lib/python3.9/site-packages/shimmy/openai_gym_compatibility.py", line 251, in step
    obs, reward, done, info = self.gym_env.step(action)
  File "/linux/meghislain/ARIES-RL/ARIES/env_sans_dose3D.py", line 247, in step
    self.perfect_DM = self.observeEnvAs2DImage(pos = np.round(self._tumor_position), dose_q=self.dose_quantity, targetSize = self.targetSize, form = self.form)
  File "/linux/meghislain/ARIES-RL/ARIES/env_sans_dose3D.py", line 711, in observeEnvAs2DImage
    envImg_shifted = scipy.ndimage.shift(envImg, shift, order=1)
  File "/home/meghislain/.conda/envs/STB3/lib/python3.9/site-packages/scipy/ndimage/_interpolation.py", line 664, in shift
    output = _ni_support._get_output(output, input,
  File "/home/meghislain/.conda/envs/STB3/lib/python3.9/site-packages/scipy/ndimage/_ni_support.py", line 79, in _get_output
    output = numpy.zeros(shape, dtype=input.dtype.name)
  File "/home/meghislain/.conda/envs/STB3/lib/python3.9/site-packages/numpy/core/_dtype.py", line 346, in _name_get
    def _name_get(dtype):
KeyboardInterrupt